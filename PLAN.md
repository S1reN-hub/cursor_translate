# Translate 中英文互译 — 开发计划

基于 [README.md](./README.md) 产品文档的完整实现计划，用于从零搭建 Translate 应用。

---

## 1. 目标与范围

| 项目     | 说明 |
|----------|------|
| **产品** | 基于 AI 的中英文双向翻译 Web 应用 |
| **技术栈** | Next.js + React + TailwindCSS + DeepSeek API |
| **交付** | 可本地/线上运行的单体应用，支持翻译、双模式展示、语音、历史与收藏 |

---

## 2. 技术选型确认

| 层级     | 技术 | 用途 |
|----------|------|------|
| 框架     | Next.js 14+ (App Router) | 前后端一体、API Routes、SSR/静态 |
| UI       | React 18 + TailwindCSS | 页面与组件、样式 |
| 语音     | Web Speech API (SpeechSynthesis) | 中英文 TTS |
| AI       | DeepSeek Chat API | 中英互译 |
| 状态     | React state / Context 或 Zustand | 界面状态、历史列表 |
| 持久化   | 先 localStorage；可选 PostgreSQL/MongoDB | 历史与收藏 |

---

## 3. 阶段划分

### Phase 0：项目初始化（前置）

- [ ] 使用 `create-next-app` 创建 Next.js 项目（TypeScript + Tailwind + App Router）
- [ ] 配置 ESLint / Prettier，统一代码风格
- [ ] 配置 `.env.local` 与 `DEEPSEEK_API_KEY`，并加入 `.gitignore` 说明
- [ ] 在 README 中补充「快速开始」与「环境变量」说明

**产出**：可运行的空白 Next 应用，环境变量就绪。

---

### Phase 1：核心翻译能力

- [ ] **1.1 后端**
  - [ ] 新建 API Route：`POST /api/translate`
  - [ ] 请求体：`{ text: string }`；响应：`{ translated: string, detectedLang?: string }`
  - [ ] 调用 DeepSeek Chat API，使用固定 system prompt 约束「仅输出译文、中英互译」
  - [ ] 错误处理：API 失败、超时、限流返回明确错误码与文案
- [ ] **1.2 前端**
  - [ ] 翻译页布局：顶部输入框（多行）、翻译按钮、下方结果区
  - [ ] 调用 `/api/translate`，展示 loading 与翻译结果
  - [ ] 简单错误提示（如 toast 或行内文案）

**产出**：输入一段中/英文，点击翻译即可得到译文。

---

### Phase 2：双模式显示

- [ ] **2.1 数据与解析**
  - [ ] 若 DeepSeek 返回分段结果，定义简单格式（如按换行分段）；否则前端按句号/换行拆分为段落数组
  - [ ] 原文、译文均得到 `string[]` 段落，便于对照
- [ ] **2.2 整体模式**
  - [ ] 结果区以单一文本框/块展示完整译文，支持一键复制
- [ ] **2.3 对照模式**
  - [ ] 原文与译文按段落交错展示（段落 1 原文 → 段落 1 译文 → 段落 2 原文 → …）
  - [ ] 样式清晰区分原文/译文（如背景色、缩进、标签）
- [ ] **2.4 切换**
  - [ ] 顶部或结果区上方增加「整体 / 对照」切换（Tab 或 Toggle），切换时仅改变展示方式，不重新请求 API

**产出**：用户可在「整体」与「对照」两种视图间切换查看同一翻译结果。

---

### Phase 3：语音播报

- [ ] **3.1 能力封装**
  - [ ] 封装 Web Speech API（`speechSynthesis`）：播放、暂停、停止、设置语速与音量
  - [ ] 检测浏览器支持并做降级提示（不支持时隐藏或禁用语音按钮）
- [ ] **3.2 UI**
  - [ ] 在译文块或每段译文旁增加「播放」按钮
  - [ ] 可选：全局或每段独立的语速、音量滑块/下拉
- [ ] **3.3 语言与语音**
  - [ ] 根据内容或当前翻译方向选择中文/英文语音（如 `zh-CN` / `en-US`），尽量使用系统可用 voice

**产出**：用户可对翻译结果进行语音播放，并调节语速与音量。

---

### Phase 4：历史与收藏

- [ ] **4.1 数据模型（前端）**
  - [ ] 单条记录：`{ id, sourceText, translatedText, createdAt, isFavorite? }`
  - [ ] 列表存于 React 状态，并同步到 `localStorage`（key 如 `translate_history`）
- [ ] **4.2 自动保存**
  - [ ] 每次翻译成功后，将原文+译文+时间戳追加到历史列表并持久化
- [ ] **4.3 历史面板**
  - [ ] 侧边栏或底部抽屉：历史列表（按时间倒序）、支持搜索（按原文/译文过滤）
  - [ ] 点击某条可回填到输入框或仅展示，便于再次查看/复制
- [ ] **4.4 收藏**
  - [ ] 每条历史记录支持「收藏」开关，收藏列表可单独筛选展示
  - [ ] 收藏状态一并写入 localStorage

**产出**：翻译自动入历史，可搜索、回填与收藏，刷新后仍保留（本地）。

---

### Phase 5：体验与收尾

- [ ] **5.1 体验**
  - [ ] 输入框支持占位符、字数/段落提示；长文本时考虑防抖或「翻译中」禁用按钮
  - [ ] 结果区支持一键复制译文
  - [ ] 移动端基础适配（布局、字体、按钮可点区域）
- [ ] **5.2 错误与边界**
  - [ ] 未配置 API Key 时在设置页或首次请求时提示
  - [ ] 空输入、超长输入做前端校验与提示
- [ ] **5.3 文档与部署**
  - [ ] README 中补充：功能列表、环境变量、运行命令、可选的环境要求
  - [ ] 如需上线：配置 Vercel/其他平台，仅需设置 `DEEPSEEK_API_KEY` 等环境变量

**产出**：产品可交付、可部署，文档与使用说明完整。

---

## 4. 可选扩展（后续迭代）

- **多语言**：在 DeepSeek 的 system prompt 中扩展为「多语种↔中文」或「多语种↔英文」
- **数据库持久化**：将历史/收藏迁至 PostgreSQL 或 MongoDB，并增加用户账号（可选）
- **快捷键**：如 Ctrl+Enter 触发翻译、Ctrl+C 复制译文等
- **导出**：将当前翻译或历史导出为 TXT/Markdown

---

## 5. 里程碑与优先级

| 里程碑       | 包含阶段   | 优先级 |
|--------------|------------|--------|
| M1 能翻译    | Phase 0–1  | P0     |
| M2 双模式    | Phase 2    | P0     |
| M3 语音      | Phase 3    | P1     |
| M4 历史收藏  | Phase 4    | P1     |
| M5 上线就绪  | Phase 5    | P1     |

建议按 Phase 0 → 1 → 2 → 3 → 4 → 5 顺序执行，每阶段验收通过后再进入下一阶段。

---

## 6. 风险与依赖

- **DeepSeek API**：需有效 API Key 与网络；需遵守调用频率与长度限制。
- **语音**：依赖浏览器与系统 TTS，部分环境可能无中文或英文语音包，需降级提示。
- **历史**：仅 localStorage 时，清缓存会丢失；若需多端同步需引入后端与账号体系。

---

*计划文档与产品定义以 [README.md](./README.md) 为准，开发过程中可据此拆分为 Issue 或任务卡片执行。*
